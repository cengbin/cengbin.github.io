# 开发代码规范

### 1.1 代码质量规范

前端使用ESLint工具做代码质量检测。JavaScript代码应符合 ESLint 预定义的 eslint:recommended 编码规则。

### 1.1.1 ESLint 实践

**安装：**

`npm install --save-dev eslint@8.52.0`

**使用：**

项目根目录添加.eslintrc.js文件，内容如下：

```
module.exports = {
	env: {
		es6: true,
		browser: true,
		node: true,
	},
	parserOptions: {
		ecmaVersion: 'latest',
		sourceType: 'module'
	},
	extends: ['eslint:recommended'],
	rules: {
		// 生产模式不允许使用log
		'no-console': process.env.NODE_ENV === 'production' ? ['error', { allow: ['error', 'warn', 'info'] }] : 'off',
		// 生产默认不允许使用debugger
		'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off',
		// 在注释中的 // 或 /* 之后强制执行一致的间距
		'spaced-comment': 'error',
	}
}
```

[ESLint内置规则](https://zh-hans.eslint.org/docs/latest/rules/) 

修改package.json，添加eslint命令：

```
"scripts": {
	"eslint": "npx eslint --ext .js,.vue src",
	"eslint:fix": "npx eslint --ext .js,.vue src --fix",
},
```

通过npm run eslint 进行代码检测。

通过npm run eslint:fix 进行代码自动修复。

至此ESLint基础配置就完成了。

### 1.1.2 Vue项目实践

Vue 团队维护着 eslint-plugin-vue 项目，它是一个 ESLint 插件，会提供 SFC 相关规则的定义。

Vue代码应符合 vue3-recommended 编码规则。

官方文档[点击这里](https://eslint.vuejs.org)

规则列表[点击这里](https://eslint.vuejs.org/rules/)

**安装：**

`npm install -—save-dev eslint-plugin-vue@9.25.0`

**使用：**

修改.eslintrc.js，如下：

```
module.exports = {
	…
	extends: ['eslint:recommended', 'plugin:vue/vue3-recommended'],
	rules: {
		…
		'vue/no-unused-vars': 'error',
		'vue/multi-word-component-names': 'off'
	}
}
```



至此Vue项目的ESLint基础配置就完成了。

#### 1.1.2.1 Vite创建的Vue项目

如果想要在vite运行的时候自动检测eslint规范，并且在页面提示错误信息。

**安装：**

`npm install -—save-dev vite-plugin-eslint@1.8.1`

**使用：**

```
import { defineConfig } from 'vite'
import eslint from 'vite-plugin-eslint'

export default defineConfig({
  plugins: [eslint()]
})
```

### 1.1.4 React 项目实践

官方文档[点击这里](https://github.com/jsx-eslint/eslint-plugin-react#configuration)

**安装**

`npm install eslint-plugin-react@7.34.1 --save-dev`

**使用**

配置 eslintrc.js 文件。

第一步：使用React的预设，来获得合理的默认值：

```
"extends": [
	"eslint:recommended",
	"plugin:react/recommended"
]
```

第二步：将“react”添加到插件部分。

```
{
  "plugins": [
    "react"
  ]
}
```

第三步：启用 JSX 支持。

```
{
  "parserOptions": {
    "ecmaFeatures": {
      "jsx": true
    }
  }
}
```

第四步：设置React的版本号。

```
settings: {
	react: {
		version: '18.2.0'
	}
}
```

启用您想要使用的规则。

```
  "rules": {
    "react/jsx-uses-react": "error",
    "react/jsx-uses-vars": "error",
  }
```


### 1.2 代码风格规范

Prettier (adj. 更漂亮的) 用来进行代码风格的统一，统一的代码风格能保证代码的可读性。

**安装：**

`npm install -—save-dev prettier@3.2.5`

**使用：**

在项目根目录添加Prettier配置文件.prettierrc.js。内容如下：

```
module.exports = {
	printWidth: 120, // 规定一行的最大宽度，在超过设定的宽度后会自动换行。默认为 80。
	tabWidth: 2, // 设定缩进的空格数。默认为 2。
	useTabs: true, // 确定是否使用 tab 进行缩进。默认为 false，即使用空格进行缩进。
	singleQuote: true, // 设定是否使用单引号。默认为 false，即使用双引号。
	semi: false, // 决定是否在语句末尾加上分号。默认为 true。
	trailingComma: 'none', // 规定是否在对象或数组的最后一项后面添加逗号。可选值为 “none”、“es5” 和 “all”。
	bracketSpacing: true // 决定在对象字面量的括号内是否添加空格。默认为 true。
}
```

使用 Prettier 格式化所有文件：

`npx prettier . --write`

使用 Prettier 检查文件是否已格式化：

`npx prettier . --check`

### 1.2.1 Prettier 与 ESLint 集成

首先，我们先安装eslint-plugin-prettier、eslint-config-prettier 插件，有了这两插件可以让你像运行 ESLint 规则一样运行 Prettier。

**安装：**

`npm install -—save-dev eslint-config-prettier@9.1.0`

`npm install -—save-dev eslint-plugin-prettier@5.1.3`

**使用：**

修改ESLint配置文件.eslintrc.js：

```
module.exports = {
	…
	extends: ['eslint:recommended', 'plugin:vue/vue3-recommended', 'prettier'],  //使用 eslint-config-prettier 的规则进行代码检查
	plugins: ['prettier'], // 使用 eslint-plugin-prettier插件调用prettier对你的代码风格进行检查
	rules: {
		 // 被prettier标记的地方报error
		'prettier/prettier': 'error',
		…
	}
}
```

### 总结

我们统一使用prettier的风格是为了团队和睦，世界和平，我们做出的牺牲都是必要的。而且prettier的样式风格已经在很多大型开源项目中被采用，比如react、webpack、babel。

参考：

[工具链](https://cn.vuejs.org/guide/scaling-up/tooling.html)

[eslint-plugin-vue](https://eslint.vuejs.org/user-guide/#usage)


